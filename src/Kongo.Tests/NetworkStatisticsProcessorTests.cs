using Kongo.Core.DataProcessors;
using Kongo.Core.DataServices;
using Kongo.Core.Interfaces;
using Kongo.Core.Models;
using System;
using System.IO;
using System.Threading.Tasks;
using Xunit;

namespace Kongo.Tests
{
	public class NetworkStatisticsProcessorTests
	{
		const string _singleNetworkStatisticRecord = "[{\"establishedAt\":\"2019-10-20T14:14:39.484708400+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"c0d32296a9cec2394cab4714b44f1d4c348c727c88d7a7d4e595c62e3219d660\"}]";
		const string _networkStatisticsStream1 = "[{\"establishedAt\":\"2019-10-20T14:14:39.484708400+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"c0d32296a9cec2394cab4714b44f1d4c348c727c88d7a7d4e595c62e3219d660\"},{\"establishedAt\":\"2019-10-20T14:16:27.707837+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"926391ace41c4074c98458f254d6318a8f4ef2e12ddf4145e00596b256777fa8\"},{\"establishedAt\":\"2019-10-20T14:17:17.926803900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"b35fe616d6a680fd3d84b74d322ec117d5a351d3b57b3ffdfe0ff527ce1f4aeb\"},{\"establishedAt\":\"2019-10-20T14:20:17.134684100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"67ce4b612bac2b86fe15fcfddd1d3fc3997aea5d204dce003fe96c593f51ed9a\"},{\"establishedAt\":\"2019-10-20T14:20:56.586579100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"61122728461e3714ba43ad676e6e5f9057a4bd7e04eae0b55123562b41bee678\"},{\"establishedAt\":\"2019-10-20T14:26:06.901149400+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"a042da1be8d2c9feee16058d7a8c5cdab4e2f701b9d0241f4eab5a5e9ce00cb7\"},{\"establishedAt\":\"2019-10-20T14:26:07.026154100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"0614ee6f742dc964ef2bd5d5a17b1a712f47db64c4bb6b038235027aab155b92\"},{\"establishedAt\":\"2019-10-20T14:30:59.865211100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"7ba5eda014996dd2df895ecc9409b4a1fd49c439b49ab8631187d7c4b4b185ff\"},{\"establishedAt\":\"2019-10-20T14:31:07.287921700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"273117200112edc18c44517efb5c5fbcee18f18000e4b2d8f6197414c2ac6437\"},{\"establishedAt\":\"2019-10-20T14:32:40.950619700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T14:32:44.101552100+00:00\",\"nodeId\":\"4b91adc37933a489458bb6b894967a4be178fcc87e98d1f0befc078221d2a104\"},{\"establishedAt\":\"2019-10-20T14:32:47.534441700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"a7da87697249346d8ac92f2f1cae43b421926a86d734f94ebdd87ae628974c93\"},{\"establishedAt\":\"2019-10-20T14:34:37.689178600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"10bdd6cbbeb60a971fec3748fa5dee0722dbf793b1cb441adc7da1adf65e8b23\"},{\"establishedAt\":\"2019-10-20T14:36:27.567289500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"d40a0eecda2904b03a462f2d8c133ddf20308b6246b71d348cf43452f7be2b1f\"},{\"establishedAt\":\"2019-10-20T14:37:47.838535+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"ff236b31bc161aa9f7229ae8502a9e568855a484f93507dfee61952f8fffc196\"},{\"establishedAt\":\"2019-10-20T14:38:02.457418200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T14:38:05.227644700+00:00\",\"nodeId\":\"c42b067fe16bb7b017e28b4131a91a273b906a9906004b8a1a838e84aba3cdbf\"},{\"establishedAt\":\"2019-10-20T14:38:13.864344200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"37d1c00056d4e86f3906cb4c24d8a2bacb8e03d495a860e9e753534d728f2108\"},{\"establishedAt\":\"2019-10-20T14:41:37.677086600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"f96691b99f0716021e1ffde63da6c11795d5fc750bbe48221a9b002587dd1346\"},{\"establishedAt\":\"2019-10-20T14:43:37.633041600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"0901f74b9cc385be853a4855624a78317c53ef384a373f43b546e2b6a6de5b5a\"},{\"establishedAt\":\"2019-10-20T14:45:18.269452800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"da5060075da10271359d6a49010c9252dc685f8238fb6352060f9ac212413e0b\"},{\"establishedAt\":\"2019-10-20T14:46:58.020151800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"1a25c95ca30146fe8c6131a92893eda8c66ca80377666606bee797f31ccf4eb7\"},{\"establishedAt\":\"2019-10-20T14:48:49.101925800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"f1f16381ddd807d4f77f0995232457ad6b0cb0b0255dc2ea81fd2f8c5f6eb65e\"},{\"establishedAt\":\"2019-10-20T14:48:47.593326200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T14:48:55.782922100+00:00\",\"nodeId\":\"7004ce2ec5aa29860581dc1b7ff2013fc1f82f3de276ccf3f8f4d67333b2110b\"},{\"establishedAt\":\"2019-10-20T14:49:43.775571400+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"1366d9d3ae3f92d15d79edb1104aee89c0c5f6c6e72e4a9c136c62b2e1fd08f7\"},{\"establishedAt\":\"2019-10-20T14:50:47.631394500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"0c8ec7e1c0a9bb0c2ecca01a01c6f11c5c686cb45ac9b943b04c22641766bddc\"},{\"establishedAt\":\"2019-10-20T14:52:28.278667200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"708dc49955b5322deecb69c528a5c43676bcb1146df398da4bb89c17688f305e\"},{\"establishedAt\":\"2019-10-20T14:54:17.876782900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"a86e9b3d3d0dc0d9e7dfff946098a283e5e33d97f3f148929e7ffedd67c396c7\"},{\"establishedAt\":\"2019-10-20T14:55:57.858904900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"e4b532430930b9ea6b339cb5f696da97e2f384dd3ae1745354b5e6bf9af705f1\"},{\"establishedAt\":\"2019-10-20T14:57:38.092989900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"4a8017429340436ed4a687392bd0d70c4fbe8b9300fdfb75fcc754b8155c4077\"},{\"establishedAt\":\"2019-10-20T15:00:57.838264900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"b92c84426a5a3c6955596e65a666ec7a5770016b325f8b063a16b276816663ae\"},{\"establishedAt\":\"2019-10-20T15:01:01.068126600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"f62d3f7ceb4da6a7152f9a268c3861ccfe55054aca3fa6468ef00bc56795a321\"},{\"establishedAt\":\"2019-10-20T15:02:37.684665100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"fc66710d2b1ff20f290989f18923a008ac78b18035041cc0222e98bdea9d2882\"},{\"establishedAt\":\"2019-10-20T15:04:17.980632200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"9d1a54bb966ba5f3ce0a73c3460ea8484d6417e0a25f071c039c3432689f4235\"},{\"establishedAt\":\"2019-10-20T15:04:28.271786200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"125ba70d81d925354aadcac4791e54190e0d1a72ba4f279e12f4bab26fe4fd8f\"},{\"establishedAt\":\"2019-10-20T15:06:35.879770900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"1f5dfa25d5b796db9291db120b20648f07bae1923ddcd23d74cefbc07fb6fd4e\"},{\"establishedAt\":\"2019-10-20T15:06:47.689173800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"61719d60e7140cc14faee7e34a10c0f2fe35604c6f841e5cec4d56bb363e5903\"},{\"establishedAt\":\"2019-10-20T15:07:48.124785700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"9217e77c148cb298970b877737d961ca161066c6c896e81957edf2ed64bd394d\"},{\"establishedAt\":\"2019-10-20T15:11:14.958761800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"e48e3baedac8e0aed90926de52ce233d5d18dbae5e1d3a168cb4c9859f908f15\"},{\"establishedAt\":\"2019-10-20T15:15:44.632865400+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"31bdab1578786b0aade2d251ffe976efbe86396d5df5b14a8f758a8d75138f38\"},{\"establishedAt\":\"2019-10-20T15:16:30.146195600+00:00\",\"lastBlockReceived\":\"2019-10-20T15:16:38.813799+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"6be4337bd6cc8bff1c0dbe05bd0fe55b1f4d060bff26fe15627d939702273259\"},{\"establishedAt\":\"2019-10-20T15:18:07.162275300+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"3bdaa6553df1eae6dd79728ef3f95ff90d8599becbe5829dae5b421f7f49a4b8\"},{\"establishedAt\":\"2019-10-20T15:22:45.198827300+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"78239110ef050baa72791a06fc962aae9df90c5c555c5fa105bb81bca910dd7d\"},{\"establishedAt\":\"2019-10-20T15:27:28.377521700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"13547e906eea5f3280e64a44acd7d19c1b41c6214c78887c0ab90cf28e28e505\"},{\"establishedAt\":\"2019-10-20T15:38:17.508988800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"751a6dd97e9d11c32059d39732e600541def87a32ac345fd58d0e7743e9a53ac\"},{\"establishedAt\":\"2019-10-20T15:41:47.922607100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"190ca09c49a1f6517866ed656a744d30ee14d61fa57bd7a8ce2fb268fe0e68a7\"}";
		const string _networkStatisticsStream2 = ",{\"establishedAt\":\"2019-10-20T15:43:57.866290200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"d9ebf521ab7422b8541f6288c7b55b8873d6d735fca0c74a5963545a02864527\"},{\"establishedAt\":\"2019-10-20T15:46:58.126565600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"a22b88ed784b31853cf7edeb2ddb0e65a9630cf1b47e7e35b7d6502379aa6ad1\"},{\"establishedAt\":\"2019-10-20T15:50:38.336474800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"6cedd3e0c23e21c4b366281bbd566fa0796ad5f147e18d79ea2f404934213918\"},{\"establishedAt\":\"2019-10-20T15:26:32.753044+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T15:52:13.934886900+00:00\",\"nodeId\":\"7baad60aef1705f3de1361bf970dd95cd7f162df00b0135bf71eae852bbcb248\"},{\"establishedAt\":\"2019-10-20T15:52:18.107666500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"72d515cfb7461043281395265462d178eba055d32ec98668cb5c9d18ddc3328d\"},{\"establishedAt\":\"2019-10-20T15:54:08.312105900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"5137e8c6b81ab682bf5bfa6c86b7c4b5fbabad612af0e6311185a2aad64318ef\"},{\"establishedAt\":\"2019-10-20T15:57:27.981317800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"ee51b9336ed0c1eb69ecb4bbdbbb50d28c12f1fa073d4aadf4ce03ddfc2ac285\"},{\"establishedAt\":\"2019-10-20T16:15:29.643740100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"cfb4032c4ce8a42ff9280ed59219f7bdd57e97de5f0f7d65d57be122a5215050\"},{\"establishedAt\":\"2019-10-20T16:15:48.600614100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"7126c114970b3195150e21ede2783507cdec412d15b5884a5eff078d27883e85\"},{\"establishedAt\":\"2019-10-20T16:19:27.903801+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"71bfd49548f14a247de048823f033ba41c0ca641f6bd293d7fe26767184badb3\"},{\"establishedAt\":\"2019-10-20T16:22:48.824113200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"66dd8d40de0313b78344810209d4d21ed3569a73e1accb88a0edafd0d4c7b142\"},{\"establishedAt\":\"2019-10-20T15:03:46.093473600+00:00\",\"lastBlockReceived\":\"2019-10-20T16:08:59.014406900+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T16:35:29.207666400+00:00\",\"nodeId\":\"25097ff9d6421517da7aa2b1b2a0fe62311786dd61323cb1b7c1ea7f29fc9542\"},{\"establishedAt\":\"2019-10-20T16:35:57.394159800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"bbef7ac4e9c3f896f815800616157b277fe84c8c64e276f756bbc1a51140b481\"},{\"establishedAt\":\"2019-10-20T16:36:45.286708+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"4085f8b5ce0be913dca3aed1e5e9475170b995fd3b7cf7175ae616cc0f8cccdc\"},{\"establishedAt\":\"2019-10-20T16:36:58.757400800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"d716b0cf69581aedfd63e1bc5cde9c6c8e625fcec309099e09b2967e22694f3a\"},{\"establishedAt\":\"2019-10-20T16:38:38.763288900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"d2b7257687a36c88f6e1048494f9d7914091dcccf327b7fa7d498e770e649cc7\"},{\"establishedAt\":\"2019-10-20T16:38:58.745897600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"c261e0727f31edb08a0bd7d333d7b381b41c093ebed2716f180fd6a325c9481f\"},{\"establishedAt\":\"2019-10-20T16:45:30.093114600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"9a02c89fc0edaaabaeed0d47d7e0286337b95048b525141e928327a8ae0d4871\"},{\"establishedAt\":\"2019-10-20T16:50:27.259473100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"2e5abf6a24112f9a35bf6d2f1a0300e92dbd54e3c80189aef8c0ddd31aed6e3e\"},{\"establishedAt\":\"2019-10-20T16:53:48.558898200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"4967574dab992b0fa789c9eb244d2727f3d4367068b98ba09b87f82d0f33520b\"},{\"establishedAt\":\"2019-10-20T16:53:58.908692900+00:00\",\"lastBlockReceived\":\"2019-10-20T16:53:58.971219800+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"3fa2335570404d6d470a7cbcbef1dd6b5d98fc873ec824571ef4302435adccb1\"},{\"establishedAt\":\"2019-10-20T16:54:18.691441+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"b0550855624471876761e160849349cab01bf810eb4351c94d3cf8bf5f9303ae\"},{\"establishedAt\":\"2019-10-20T16:13:41.121728300+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T16:54:43.546951200+00:00\",\"nodeId\":\"ba9c0c0cb7238f1318535a20b44ac965bc7eb8df87be3bdde1d748dd15711c72\"},{\"establishedAt\":\"2019-10-20T16:56:40.744324+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"d45ac1e42dfaeb50dfec27d4f2ad4032d47b6c8a1141303a276b6f3b011138aa\"},{\"establishedAt\":\"2019-10-20T16:46:42.240873500+00:00\",\"lastBlockReceived\":\"2019-10-20T16:46:42.272155200+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T16:58:11.619810+00:00\",\"nodeId\":\"79606523f55a544e91732d6b54ff857608ecb42c4d249c0ccf52a9b813e7ca3e\"},{\"establishedAt\":\"2019-10-20T16:40:06.313613500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:00:51.776555500+00:00\",\"nodeId\":\"c64890d071f0bf232ef01a43f4d5becfdf53dd0dd0b05e8017167bbeed1c9715\"},{\"establishedAt\":\"2019-10-20T17:01:24.592484300+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"18295382f861161c6696124269101f993e03ec47b41ca5ea45846a7fbed2c835\"},{\"establishedAt\":\"2019-10-20T15:26:55.322472600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:02:02.098334300+00:00\",\"nodeId\":\"2206f206db535d8851183eda4b12ccf1a490ffe5c3b0c65f03ddc9d67d21f006\"},{\"establishedAt\":\"2019-10-20T17:03:16.206102100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"75ede09706445d80c440d71b812b8d0ad08ac668081abbeda34b0914bc450579\"},{\"establishedAt\":\"2019-10-20T17:05:25.252759500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:05:43.734084900+00:00\",\"nodeId\":\"79cee6aba6586dd08f5e0e7e39f043ec453315ad4529865e2790ab596d3a3997\"},{\"establishedAt\":\"2019-10-20T17:04:43.855132300+00:00\",\"lastBlockReceived\":\"2019-10-20T17:04:44.027015200+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:06:11.403184400+00:00\",\"nodeId\":\"794d5a2cf42b4cc35ca3315869b8415f759f3c49bc5d392f006c5eaf9450dc2a\"},{\"establishedAt\":\"2019-10-20T17:07:18.407825100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"72f6244e0c74ea3108a7ebb4db38144a607691cf349e6d72b0b070496782736c\"},{\"establishedAt\":\"2019-10-20T17:07:26.171945600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:07:34.241827300+00:00\",\"nodeId\":\"36998728589be8263c0fe61de18a570423a89f0aae1004e48463a766c5e7d39a\"},{\"establishedAt\":\"2019-10-20T17:07:35.480443500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"96f57e8009a714129629501e315854e6d61355c8ab60d5dde8746b82b2c10957\"},{\"establishedAt\":\"2019-10-20T17:08:02.014102400+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"6d5ce3e51842b41050cf4774f5e33acee1e2c3d3a8273eea8d766aab2d4e2539\"},{\"establishedAt\":\"2019-10-20T17:08:41.248135900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"91672571fddfd0a3d95e0b955b8f2f62c818a32f35c1ab97667033c1d4fcaea3\"},{\"establishedAt\":\"2019-10-20T17:08:52.319854200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"80ee2d2aaf97765ecf8ece03cece050aa75de3a47eef229b4e5e938eb455825d\"},{\"establishedAt\":\"2019-10-20T17:08:45.415275900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:08:54.700202600+00:00\",\"nodeId\":\"0624d88a8c4a3a4ecb6fc622488dea0c4071573934320461b9d6c95ddf1aad4a\"},{\"establishedAt\":\"2019-10-20T17:10:08.900637100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"1eaa236a3863dcd4dc6f7c6c87d0640f8bb7a6d7d4477304a0971a458d8e65da\"},{\"establishedAt\":\"2019-10-20T17:11:29.223886900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:11:44.205989800+00:00\",\"nodeId\":\"706ffbf01ae0f0909345676fb087809245938a6701dccc1bd5baf484575e324e\"},{\"establishedAt\":\"2019-10-20T17:11:46.839866200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"59c0723521c56a5121032ed298057b4af6cf4fe0a540eaa0616e83dbf298ada8\"},{\"establishedAt\":\"2019-10-20T17:12:22.137578900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"ed7aa388b02a86381731981254ba7f95951e321e52c27fb776bb8694f2708201\"},{\"establishedAt\":\"2019-10-20T17:12:41.985121100+00:00\",\"lastBlockReceived\":null";
		const string _networkStatisticsStream3 = ",\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"2f8e9fd94fe0a031852a4c8448192a8686c13d78eb65c7b64f015060e613b6cf\"},{\"establishedAt\":\"2019-10-20T14:14:36.451824400+00:00\",\"lastBlockReceived\":\"2019-10-20T14:25:38.384859200+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:13:53.359506700+00:00\",\"nodeId\":\"c7da5e9d60d3274cdf72b30c5b844993348ba76c7c66b2437431ee11800ab551\"},{\"establishedAt\":\"2019-10-20T17:08:01.629079900+00:00\",\"lastBlockReceived\":\"2019-10-20T17:17:19.547144300+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:10:05.206564700+00:00\",\"nodeId\":\"79d0195472bd4bc403435b7992abf3a142ef4cb51341ea45283bdd85fc824fb5\"},{\"establishedAt\":\"2019-10-20T17:22:18.023598200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"52a0ebc562a2957432fb3f95c99b33ff49f6498e292a1fcbaa079c004f07a971\"},{\"establishedAt\":\"2019-10-20T17:22:11.370628400+00:00\",\"lastBlockReceived\":\"2019-10-20T17:24:53.420278+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:22:31.248077600+00:00\",\"nodeId\":\"4ba51d93113a62d4bb2e0513f601f40b9b5268a4d2246231927a3d1e8a4398f2\"},{\"establishedAt\":\"2019-10-20T16:54:08.970118700+00:00\",\"lastBlockReceived\":\"2019-10-20T17:25:45.200735800+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T16:54:12.914121500+00:00\",\"nodeId\":\"38653a7000b9feeb67b90a73db46003b0c2c58e077732936ccaf85dddfc59ac2\"},{\"establishedAt\":\"2019-10-20T17:32:38.571566500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"c2a0595d5cccc38c113818fe3c25c3f40beb17b6715a3b93c74fac928d4e219f\"},{\"establishedAt\":\"2019-10-20T17:39:27.597758100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"f442f0131a058ec3977dc9767fa60406a5916a77235b11365741087f687ff2f9\"},{\"establishedAt\":\"2019-10-20T17:40:19.447133300+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"65551a3d66d633661b29458bb5e8f17749c45bd20245ff47dad9db9b6ae8d6fc\"},{\"establishedAt\":\"2019-10-20T14:13:44.346901800+00:00\",\"lastBlockReceived\":\"2019-10-20T17:40:50.158198200+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:35:36.545719700+00:00\",\"nodeId\":\"6e60fe03e7207aba040c40bc52daa1217f42789d93ef2c23aad76a4995ac0620\"},{\"establishedAt\":\"2019-10-20T17:04:53.740627300+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:43:06.098377300+00:00\",\"nodeId\":\"c1efc9af36daab56ec228f9e7818d19c9966526535c3d720673a4a7ad832b384\"},{\"establishedAt\":\"2019-10-20T17:46:59.284632900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"84de14b57f4d9098d15fcde83718cc661319e19ebd87f4118b067eb4987b5f15\"},{\"establishedAt\":\"2019-10-20T17:55:07.664371700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"3d8a335b6078b962db537989520b5e5f12e591a41b173842c4f6d88354c433cb\"},{\"establishedAt\":\"2019-10-20T14:58:38.446606800+00:00\",\"lastBlockReceived\":\"2019-10-20T17:01:59.400658400+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:58:22.004127200+00:00\",\"nodeId\":\"7353576437975b6200a55c8e4afe8281a33024802e904e442a4ad513e6d142ed\"},{\"establishedAt\":\"2019-10-20T17:58:53.766810700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"560f4346358459c4314d640c6592c4fd339a266377c8c20d1ff3279998cde848\"},{\"establishedAt\":\"2019-10-20T17:10:05.661473200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:59:11.199477100+00:00\",\"nodeId\":\"7468c5e8cc3e937f7f428c92f21c336380e78d599b02e224c3ae815449ef7278\"},{\"establishedAt\":\"2019-10-20T17:59:31.658887800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"a1d431e499ad071c9d9219159802ff9fe5a9c1939c2c8d1f5b34b77a9a722e48\"},{\"establishedAt\":\"2019-10-20T18:02:08.637984500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"915f55f89152403a6cefe71005b3973f5b399e1d3391ec72a4eed3ee79dbab3e\"},{\"establishedAt\":\"2019-10-20T18:03:51.428643600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"39210839e175c1a8164f4950e248eefc6f9ce3e1ef2ebf7ab7c4c4031600a68e\"},{\"establishedAt\":\"2019-10-20T18:03:53.276680800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"220ad176bcfa24a908356c9e7a920620719994b17566c088c53b885d7ae88208\"},{\"establishedAt\":\"2019-10-20T18:08:11.731838300+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"ea34f938b544e3148f1765fcb197f4c80801a84b4af99a7ecf99b694320e9bda\"},{\"establishedAt\":\"2019-10-20T15:11:28.633877+00:00\",\"lastBlockReceived\":\"2019-10-20T18:09:03.363558500+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"d7c35f78c75865ca817b5bd41a02e6d5421fb3941d6ce2bf3b95e471d855b82a\"},{\"establishedAt\":\"2019-10-20T18:10:31.434869500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"13d1552830a36fb1898c5bd9e8f04beae334343b530db1851b72bcfd0ba37ef0\"},{\"establishedAt\":\"2019-10-20T18:12:23.793859300+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"b9e02a8c512c61745d53a3594c755d9a6a26ee483fefc80a5be61d6cb47b50a1\"},{\"establishedAt\":\"2019-10-20T18:13:37.024638700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"351b99f1b7daa4e548a770e3dbe259f3c7d13a456bead2d1b6b5775702f8fcb0\"},{\"establishedAt\":\"2019-10-20T18:14:08.520357800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"e6daa4571cdbb6f9414e715ed102473cb2f8e2b24c36700b432e5cb84dfa4488\"},{\"establishedAt\":\"2019-10-20T15:39:34.969011500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T18:16:14.081724200+00:00\",\"nodeId\":\"1bf02b2b51845c883b5236f6f6eb60dc9bd54a010723522bd8360b4f0182ad5e\"},{\"establishedAt\":\"2019-10-20T18:16:17.466318100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"52effb341cb66458632d0824a184a26b8667df70fcd6c2d12017072d890c7d28\"},{\"establishedAt\":\"2019-10-20T14:59:28.681115900+00:00\",\"lastBlockReceived\":\"2019-10-20T16:06:06.002029900+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T18:18:12.538509300+00:00\",\"nodeId\":\"9fa7077c817debadd60ecf3eaab08fbac60f8a03eb4d2a53a3f91efc93576129\"},{\"establishedAt\":\"2019-10-20T18:21:14.609041900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"f286f4b596c377f2a874d0d562d4e46d6052e21ac320e2770152bb672b484853\"},{\"establishedAt\":\"2019-10-20T14:21:54.050311+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T18:23:15.707660400+00:00\",\"nodeId\":\"a54b2069cad39b9f92cb305ce1b9ce8117487e452cfe9608124e5bbb136a6ac8\"},{\"establishedAt\":\"2019-10-20T17:23:02.528558700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T18:26:32.441972200+00:00\",\"nodeId\":\"7959ddbcb21cda18b6366ff35cfbc7b4de1c1eff0a35fbc8088cc16826007a47\"},{\"establishedAt\":\"2019-10-20T17:44:40.068841500+00:00\",\"lastBlockReceived\":\"2019-10-20T18:32:22.025343300+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:44:53.750106400+00:00\",\"nodeId\":\"d35a605d59fe79c1f9456f5117f61def51609da763e79e0b5d0befa0417aaab1\"},{\"establishedAt\":\"2019-10-20T18:40:40.036692400+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T18:41:10.409162900+00:00\",\"nodeId\":\"6d008612cd3899ac434a404c30f0541426c9bd803ae2f8ef4b5ce7e0f0383388\"},{\"establishedAt\":\"2019-10-20T18:43:20.691137300+00:00\",\"lastBlockReceived\":\"2019-10-20T18:43:20.847696300+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"a9634177ae649f91a0fbca0f2e01a200cf56a1a5285e5f1f38f08bfde6999794\"},{\"establishedAt\":\"2019-10-20T15:13:40.976582500+00:00\",\"lastBlockReceived\":\"2019-10-20T18:44:54.831856400+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"21c4c6c1f0b8ba1f5f08b8c6ca1ec781437820ba735ba209bca0fda25cf8e76a\"},{\"establishedAt\":\"2019-10-20T18:45:39.903784900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"e277491e0dfc7c23e51258cd84f66fc77b15fe9e1b71b8b3cb0ddce0b6de54b4\"},{\"establishedAt\":\"2019-10-20T18:53:57.651957800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"0a7b6a2a9a982cafeac707338f2452926c10a5d3ee73bed5dc0ac8f4a31b6572\"},{\"establishedAt\":\"2019-10-20T15:11:50.108786500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T18:58:00.389161900+00:00\",\"nodeId\":\"0c7b663e99ccaab5b9e7d4c1eabd661ce866fc629638f000ff458fc5ca4e90b8\"},{\"establishedAt\":\"2019-10-20T15:33:08.581721500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T18:58:02.335168900+00:00\",\"nodeId\":\"97ffeb2a1e17237a57c90685cbc6bbd5049f7a3a9a04216875d307d046f1d4ff\"},{\"establishedAt\":\"2019-10-20T15:06:51.557410900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T19:01:54.335646500+00:00\"";
		const string _networkStatisticsStream4 = ",\"nodeId\":\"0ab34f95c9a6004990b75ef1257b11050c56952d187763fb931297819b37f10d\"},{\"establishedAt\":\"2019-10-20T19:02:48.746019200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"f6fd30ccfd918f5a93fd456f905b49214982863f5f95dff337e5dfea7f1ddca9\"},{\"establishedAt\":\"2019-10-20T15:40:39.458793200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T19:06:02.745770200+00:00\",\"nodeId\":\"202a78b088ea14763252cd9572f9b2b11e4cc6cd5b3b06e6c3feb3b04927b264\"},{\"establishedAt\":\"2019-10-20T19:06:07.570905+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"3445ba32d704ae84a75428b1d00cf6bf3aaada5aee31c6d357f87a47c260eabd\"},{\"establishedAt\":\"2019-10-20T19:08:52.753528500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"9861dfd6450967f4c1e986d32223a5e02d44621f27186268393186f946b23c47\"},{\"establishedAt\":\"2019-10-20T17:05:05.650940300+00:00\",\"lastBlockReceived\":\"2019-10-20T19:10:04.779083200+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T17:05:21.574276+00:00\",\"nodeId\":\"7b04419bbf9bc2341e0dbab1bc7f769ff3ca881dd670204811e6b63f1826998f\"},{\"establishedAt\":\"2019-10-20T19:10:57.655974800+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"7019daa45ebfa0b6ce80a334cb46f7fe7e5169bdcb6055d92d4fea3bfd59a66f\"},{\"establishedAt\":\"2019-10-20T19:12:03.033678+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"a52ac7670753937c0939c90deef6739c13ed075d559ccc34fd917dbd2c3dd3bb\"},{\"establishedAt\":\"2019-10-20T19:13:05.868719500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"b1bd4b433709c3e1c2a5ddb9019a952cc94653dfd6dc04f483a46eeb949e5d43\"},{\"establishedAt\":\"2019-10-20T19:13:41.500526300+00:00\",\"lastBlockReceived\":\"2019-10-20T19:13:41.861133+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"2e21de6e2b61a23ec0461eee5f7db9c2a7a550a3b155e55674572d41067bfb77\"},{\"establishedAt\":\"2019-10-20T19:14:24.214978300+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"2abae362765eb12e886cfaf99fdd11b4e212c15bfbedfca869f350544c0ce336\"},{\"establishedAt\":\"2019-10-20T19:18:07.702098200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"af6aca8dfc34c065a480ba367d217372887b186e04afe3528b6245295c0f3d05\"},{\"establishedAt\":\"2019-10-20T19:20:07.741544900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"7acc65b6f52e84f538891168fc202669cd390b4fea648b05057c2740a5852878\"},{\"establishedAt\":\"2019-10-20T19:21:41.753713600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"f3e9d6b532ba3f0e54eea3771679191ded17c92fde788034a13696da84ee7376\"},{\"establishedAt\":\"2019-10-20T19:28:57.822548300+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"0ace4bfa43a01c710d1ea39474aaf39bc68ae3ec96fee6d8278de9771253e331\"},{\"establishedAt\":\"2019-10-20T19:32:48.699321100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"55b984c70702feb14b96cf12d6af436be06da9319373898fcaaf904639fef2a9\"},{\"establishedAt\":\"2019-10-20T19:33:41.125936700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"363af202355f4317cfe0fe4e368a5c36e3a83c557e3d5208291110f4fedadd14\"},{\"establishedAt\":\"2019-10-20T19:33:42.128709500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"2db7265c1fa558e2fcbcc09cb4c1e237e6c85c1700f08b8f8e2dfb7d7893cc7c\"},{\"establishedAt\":\"2019-10-20T19:35:48.583443100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"2876e078ab2f0c86caf5e2fd2718fb9c57e037cfa20e674142b3a5757e37ec1e\"},{\"establishedAt\":\"2019-10-20T19:36:05.893793900+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"d3b055acc99a05bed52b84fbf80a969df666f887990e8ff19b1f212fc3dd1182\"},{\"establishedAt\":\"2019-10-20T19:38:24.023115100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T19:38:44.326703200+00:00\",\"nodeId\":\"113d6742f86d464d91d26da52ecad0c47d58e35d5ba1ce7b7140b2cdbcf7ff29\"},{\"establishedAt\":\"2019-10-20T19:40:42.128613300+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"9084b9ac0afae19a7f1b376b6cd5b66c767ca4c276b65d96d430db0cf2864988\"},{\"establishedAt\":\"2019-10-20T19:43:11.620764500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"657127e5a8d84e956e88c98f4923e38287c672a2f19043a5971bf7d57f64bac9\"},{\"establishedAt\":\"2019-10-20T19:43:11.667639100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"7a36878ac60f05645cd889671eeaba0b47cd1b0aa8f1729fd843bc20503b22f7\"},{\"establishedAt\":\"2019-10-20T19:43:11.698908500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"d05ca82e8e41ab4a1f1a5e7723ac4c784188f800904948a60b6904e374816649\"},{\"establishedAt\":\"2019-10-20T19:45:58.331930100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"0ce28c3ea583e96bbe8e6cc5471d69884ead4b6ca90903f3e1764cf08380f5db\"},{\"establishedAt\":\"2019-10-20T14:42:41.956349200+00:00\",\"lastBlockReceived\":\"2019-10-20T18:45:26.553340+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T19:46:51.754858500+00:00\",\"nodeId\":\"2905c6beb1140052c6548e8b1ea76a99c9dc0a86b71149897336e2521a867771\"},{\"establishedAt\":\"2019-10-20T19:48:03.516046200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"e4f9ad6732d5f5c332b2ae4b81a7a39ef52b4f6b317369b01460a000835d2b0c\"},{\"establishedAt\":\"2019-10-20T19:51:31.404466100+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"20c7854d5bead6b0e9ad4849ef740a1a653e582274c311f8ea0fe3336b8aa852\"},{\"establishedAt\":\"2019-10-20T19:52:18.807060600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"55c64e0a37b2bf61923289b252bb26b785416a53559f0eda0026f46d4cd43943\"},{\"establishedAt\":\"2019-10-20T19:54:00.593623400+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"ecbe1a2457967797b113d7da77881a2aa8c5e4ea3775eaea8c55fe7bb0712881\"},{\"establishedAt\":\"2019-10-20T19:54:47.770540400+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"c6ae1965d8b62d6764c635266de4bc94d3a8692c54724e2d973274412bf78ea1\"},{\"establishedAt\":\"2019-10-20T17:02:08.887916700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T19:55:35.784602+00:00\",\"nodeId\":\"9d85ba41d4ca6b799be0579c53eb969390a25b0e44957724169ee503b04dfac2\"},{\"establishedAt\":\"2019-10-20T19:56:17.196902700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"54c886c3627092f0c85d5a54c81e5401a9a4ad8ba13b77e53bce863e5507ad87\"},{\"establishedAt\":\"2019-10-20T19:56:18.948656600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"b7f874cf47adfde6fc0e39197bf0cc7f556674f360ed02fed735ac87b1e9cfcf\"},{\"establishedAt\":\"2019-10-20T19:56:19.104942700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"c744657369b076741a85ebb31cee4ca288795311b2d948241a9dbdc049ce6d99\"},{\"establishedAt\":\"2019-10-20T19:56:19.245540700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"c76e86dde5340abb1e150eaf2ac94f9d924dccadc9819c90bc199b31eaf6db75\"},{\"establishedAt\":\"2019-10-20T19:56:19.402927600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"cf57bc502465a539cbef30138db62a463857f681c7771085a62993af778b4dce\"},{\"establishedAt\":\"2019-10-20T19:56:19.560420500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"d1c878d91cf696ad9e9443d477587e9c24a98bd6da4d6f47beb9fccf8f175733\"},{\"establishedAt\":\"2019-10-20T19:56:19.716676300+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"d7b828145d88130fa3ff77a0c56b41b08c25d738236bfe83d7c9f293e8136078\"},{\"establishedAt\":\"2019-10-20T19:56:19.857306400+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"e274ae4d1e678ae2a6ad0cb4086552f8c859d8decf3f0aef9bab6c60db34b795\"},{\"establishedAt\":\"2019-10-20T18:50:21.450435200+00:00\",\"lastBlockReceived\":\"2019-10-20T19:56:24.948105400+00:00\",\"lastFragmentReceived\":\"2019-10-20T19:08:10.800295700+00:00\",\"lastGossipReceived\":\"2019-10-20T19:54:31.279212100+00:00\",\"nodeId\":\"5da8e4c2711e95c1ff26f3088e20f7d616bc9cd034cfa8d355a5f104987c6aca\"},{\"establishedAt\":\"2019-10-20T19:56:25.122227500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"ed543b4c5eb9e95ad3c80d7d1427a74a4aa2d20706103fbb2c74f5addd36e70c\"},{\"establishedAt\":\"2019-10-20T19:56:27.012333400+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null";
		const string _networkStatisticsStream5 = ",\"lastGossipReceived\":null,\"nodeId\":\"4ef79db87b846c168fe1c1a820801ddac4406df3a9b9b2c29b368c314f865741\"},{\"establishedAt\":\"2019-10-20T19:56:27.184214700+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"554b03c870742cb5746281668d702f58c81b0e81662067716476fcd1ce03dd79\"},{\"establishedAt\":\"2019-10-20T19:56:28.122923500+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"6398dcfa61a43ad1a26a3651915e81c352dae73eb38b1be77a4c121a2a7e43a3\"},{\"establishedAt\":\"2019-10-20T19:56:28.420302200+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"7eaa425961594fe9b4d8514172f061b87b54e7c5543abfe2b24022c34aea36f4\"},{\"establishedAt\":\"2019-10-20T19:56:29.154700600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"a34b9d056229148abd26850182e6125da73ebc31c78f4c561194470172f0e2a5\"},{\"establishedAt\":\"2019-10-20T19:56:29.310955600+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"a4e349a0a539b5ab3ac493298e63f1de66433d6ebb0452b81b87ed32dedfb45e\"},{\"establishedAt\":\"2019-10-20T19:56:29.485212400+00:00\",\"lastBlockReceived\":null,\"lastFragmentReceived\":null,\"lastGossipReceived\":null,\"nodeId\":\"a88adaec6a47798d9f0a46e2c4c8947093006b28663f2889871236d1c3602b3f\"},{\"establishedAt\":\"2019-10-20T18:13:13.609469200+00:00\",\"lastBlockReceived\":\"2019-10-20T19:56:11.625176600+00:00\",\"lastFragmentReceived\":null,\"lastGossipReceived\":\"2019-10-20T19:56:30.266490800+00:00\",\"nodeId\":\"5a3dd6f296007c0ea38c65e7c32bc0a5a4ab8c08ff4774c143c53cd1599e546b\"},{\"establishedAt\":\"2019-10-20T18:51:04.840056800+00:00\",\"lastBlockReceived\":\"2019-10-20T19:36:10.394676900+00:00\",\"lastFragmentReceived\":\"2019-10-20T19:29:03.820805+00:00\",\"lastGossipReceived\":\"2019-10-20T19:56:34.895592200+00:00\",\"nodeId\":\"5cf881fb4287a6d059fd1e276cf562c47ea9f6585edb1f570550d7b769e709b0\"}]";
		const string _networkStatisticsStream = _networkStatisticsStream1 + _networkStatisticsStream2 + _networkStatisticsStream3 + _networkStatisticsStream4 + _networkStatisticsStream5;

		private IProcessNetworkStatistics _processor;

		[Theory]
		[InlineData(_networkStatisticsStream)]
		public async Task ProcessValidNetworkStatisticsStream(string value)
		{
			var storage = new KongoDataStorage($"Data Source={Path.GetRandomFileName()}");
			_processor = new NetworkStatisticsProcessor(storage);
			var networkStats = await _processor.ProcessNetworkStatistics(value);
			Assert.True(networkStats != null, "networkStats == null");
			Assert.True(networkStats.LastBlockReceivedAt != default(DateTimeOffset), $"LastBlockReceivedAt = {networkStats.LastFragmentReceivedAt}");
			Assert.True(networkStats.LastFragmentReceivedAt != default(DateTimeOffset), $"LastFragmentReceivedAt = {networkStats.LastFragmentReceivedAt}");
			Assert.True(networkStats.LastGossipReceivedAt != default(DateTimeOffset), $"LastGossipReceivedAt = {networkStats.LastGossipReceivedAt}");
			Assert.True(networkStats.TotalEstablishedConnections > 0, $"TotalEstablishedConnections = {networkStats.TotalEstablishedConnections}");
		}


		[Theory]
		[InlineData(_singleNetworkStatisticRecord)]		
		public async Task ProcessValidNetworkStatisticsStreamAllNulls(string value)
		{
			var storage = new KongoDataStorage($"Data Source={Path.GetRandomFileName()}");
			_processor = new NetworkStatisticsProcessor(storage);
			var networkStats = await _processor.ProcessNetworkStatistics(value);
			Assert.True(networkStats != null, "networkStats == null");
			Assert.True(networkStats.LastBlockReceivedAt == default(DateTimeOffset), $"LastBlockReceivedAt = {networkStats.LastFragmentReceivedAt}");
			Assert.True(networkStats.LastFragmentReceivedAt == default(DateTimeOffset), $"LastFragmentReceivedAt = {networkStats.LastFragmentReceivedAt}");
			Assert.True(networkStats.LastGossipReceivedAt == default(DateTimeOffset), $"LastGossipReceivedAt = {networkStats.LastGossipReceivedAt}");
			Assert.True(networkStats.TotalEstablishedConnections > 0, $"TotalEstablishedConnections = {networkStats.TotalEstablishedConnections}");
		}


		[Theory]
		[InlineData("")]
		[InlineData(null)]
		[InlineData("this is not a json formatted string")]
		public void InvalidNetworkStatistics_Throws_ArgumentException(string value)
		{
			var storage = new KongoDataStorage($"Data Source={Path.GetRandomFileName()}");
			_processor = new NetworkStatisticsProcessor(storage);
			Assert.ThrowsAsync<ArgumentException>(() => _processor.ProcessNetworkStatistics(value));
		}
	}
}
